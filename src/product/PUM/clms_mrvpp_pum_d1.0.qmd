---
title: "Copernicus Land Monitoring Service"
subtitle: "MEDIUM RESOLUTION VEGETATION PHENOLOGY AND PRODUCTIVITY (MR-VPP), Plant Phenology Index and VPP parameters"
date: "2022-10-06"
documentclass: scrartcl
toc: true               # Enable the Table of Contents
toc-title: "Index"      # Customize the title of the table of contents
toc-depth: 3            # Include headings up to level 3 (###)
lof: true               # Include a list of figures
lot: true               # Include a list of tables
sitemap: true
keywords: []
number-sections: false
tbl-colwidths: auto
fig-align: center
format:
  html:
    css: ../../styles/styles.css          # Optional: Custom CSS file for styling
    code-fold: true          # Allow code blocks to be foldable
    self-contained: true     # Embed resources like CSS and images
  docx:
    reference-doc: ../../styles/template0.docx
  pdf:
    latex-engine: lualatex
    header-includes: |
        % Packages for color and heading styling
        \usepackage{array}         % Enables custom padding
        \usepackage{titlesec}
        \usepackage{caption}
        \usepackage[table]{xcolor} % Enables table coloring
        
        \renewcommand{\arraystretch}{1.5} % Increase vertical cell padding (default is 1.0)

        % Define custom colors
        \definecolor{Heading1Color}{HTML}{4C6E9E} % h1 color
        \definecolor{Heading2Color}{HTML}{28497C} % h2 color
        \definecolor{Heading3Color}{HTML}{3E6BAF} % h3 color
        \definecolor{SubtitleColor}{gray}{0.5}    % subtitle color
        \definecolor{CaptionColor}{HTML}{2A5B8E}  % figcaption color
        
        % Customize heading styles
        \titleformat{\section}
          {\normalfont\Large\bfseries\color{Heading1Color}}
          {\thesection}{1em}{}
        \titleformat{\subsection}
          {\normalfont\large\bfseries\color{Heading2Color}}
          {\thesubsection}{1em}{}
        \titleformat{\subsubsection}
          {\normalfont\normalsize\bfseries\color{Heading3Color}}
          {\thesubsubsection}{1em}{}

        % Customize figure captions
        \captionsetup{
          font={footnotesize, it},
          labelfont={color=CaptionColor, bf},
          textfont={color=CaptionColor}
        }
        
        % Customize footer
        \usepackage{fancyhdr} % Required for custom headers/footers
        \pagestyle{fancy}
        \fancyhf{} % Clear all header and footer fields
        \fancyfoot[C]{\tiny\textit{MR-VPP Product User Manual Plant Phenology Index and VPP parameters, issue 1.0 } \hfill Page \thepage} % Custom footer with text and page number
        \renewcommand{\headrulewidth}{0pt} % No header line
        \renewcommand{\footrulewidth}{0.4pt} % Add a footer divider line

---

{{< pagebreak >}}

![](clms_mrvpp_pum_d1.0-media/CLMS_MRVPP_PUM_D1.0-1.jpg)

Contact:

Copernicus Land Monitoring Service (CLMS)

Project officer: Ludvig Forslund

European Environment Agency (EEA)

Kongens Nytorv 6 - 1050 Copenhagen K. - Denmark

https://eea.europa.eu

[https://land.copernicus.eu/](https://land.copernicus.eu/)

Document version:         Issue 1.0

Document date:          2022-10-06

Disclaimer:

© European Union, Copernicus Land Monitoring Service 2022, European Environment Agency (EEA)

All Rights Reserved. No parts of this document may be photocopied, reproduced, stored in retrieval system, or transmitted, in any form or by any means whether electronic, mechanical, or otherwise without the prior written permission of the European Environment Agency.

DOCUMENT CHANGE LOG

|  |  |  |  |
|----|----|----|----|
| Issue | Issue date | Pages affected | Relevant information |
| 1.0 | 06/10/2022 | All | Initial version for the 2000-2021 production |

{{< pagebreak >}}

# 1 Introduction

## 1.1 MR-VPP products summary

Copernicus is the European Union's Earth Observation Programme. It offers information services based on satellite Earth observation and in situ (non-space) data. These information services are freely and openly accessible to its users through six thematic Copernicus services (atmosphere monitoring, marine environment monitoring, land monitoring, climate change, emergency management and security).

The Copernicus Land Monitoring Service (CLMS) provides geographical information on land cover and its changes, land use, vegetation state, water cycle and earth surface energy variables to a broad range of users in Europe and across the world in the field of environmental terrestrial applications. CLMS is jointly implemented by the European Environment Agency and the European Commission DG Joint Research Centre (JRC).

Within the Pan-European component, the CLMS produced and disseminated Medium-Resolution Vegetation Phenology and Productivity (MR-VPP) at medium spatial resolution (500m x 500m). They are derived from the MODIS products MCD43A2 and MCD43A4 with a revisit time of 5 days. They are generated over the entire EEA39 (32 member countries, the UK and 6 cooperating countries in the Western Balkans).

Vegetation phenology is the description of periodic plant life cycle events across the growing seasons. Vegetation phenology with remote sensing is typically monitored by means of time series of vegetation indices. Vegetation indices address the amount of green biomass and allow the differentiation of the intensity of photosynthetic activity. This in turn depends on the plant functional types and dynamics during the growing season.

The MR-VPP product suite contains 2 product groups for 23 tiles, concluding to 1612 images per tile for the period 1.1.2000 to 31.12.2021. The three main groups of products, being (in order of production), are:

* The raw Vegetation Index (VI). Plant Phenology Index (PPI);

* The Vegetation Phenology Parameters (VPPs) product bundle are derived from the PPI index, on a yearly basis, after the end of the growing season. VPP metrics are provided for up to two growing seasons, being e.g. start of the season, end of season, seasonal productivity, etc.


![Schematic representation of the MR-VPP product bundle](clms_mrvpp_pum_d1.0-media/CLMS_MRVPP_PUM_D1.0-4.jpg){#fig-1}       

Vegetation Phenology and Productivity parameters (VPPs) are: (a) start of season (date, PPI value and slope), (b) end of season (date, PPI value and slope), (c) length of season, (d) minimum of season, (e) peak of the season (date and PPI value), (f) amplitude, (g) small integrated value, (g+h) large integrated value.

## 1.2 Scope and objectives

This document is the Product User Manual and describes the product groups for the '5-daily' Plant Phenology Index and for 'yearly' Vegetation Phenology Parameters (VPP).

The Plant Phenology Index (PPI) (Jin & Eklundh, 2014; Jin et. al., 2017) serves as input to the TIMESAT software. PPI is calculated with bands from both the MODIS MCD43A2 and MCD43A4 products. BRDF Albedo LocalSolarNoon is used as an input from the MCD43A2 product and NBAR bands 1 (RED), 2 (NIR) and 6 (SWIR) from the MCD43A4 product. Before calculating PPI, three other indices need to be derived: 1) the Difference Vegetation Index (DVI), 2) the Maximum DVI (MDVI) and 3) the DVI soil which are not archived.

DVI is calculated for each tile and is used to calculate the MDVI over the entire time-series of a pixel. DVI_(SO)ii is introduced to capture sparse vegetation areas such as drylands or olive plantations. Below are the formulas used for the indices:

$$
DVI = NIR - Red
$$
$$
MDVI = \max(DVI)
$$
$$
DVI_{soil} = \min(0.09, \frac{MDVI_{scene}}{5})
$$
$$
MDVI_{scene} = \max(MDVI) \text{ over a tile}
$$

![Overview of the PPI and VPP parameters production](clms_mrvpp_pum_d1.0-media/CLMS_MRVPP_PUM_D1.0-5.jpg){#fig-2}

PPI was calculated for every 5-days, resulting in 73 PPI points per year for each pixel. Points per year correspond to Julian days or days of the year (DOY) which also indicates that the extra days during leap years are not considered throughout the calculations. The PPI calculation is then used as an input for the VPPs production along with the calculated quality flag derived by MCD43A2 product.

## 1.3 Document structure

The document is structured as follows:

* Chapter 1 recalls the user requirements

* Chapter 2 presents product description (product file naming convention and format(s), product content and characteristics)

* Chapter 3 provides a description of the product methodology and workflows

* Chapter 5 provides information about product access and use conditions as well as the technical product support

* Chapter 6 lists references to the cited literature

&nbsp;

## 1.4 Related documents

### 1.4.1 Applicable documents

\[AD01\] Algorithm Theoretical Base Document (ATBD) HR-VPP Seasonal Trajectories and Vegetation Phenology and Productivity parameters, VI.0 2021-08-27

\[AD02\] Product User Manual HR-VPP Raw Vegetation Indices, V2.0 2021-08-30

\[AD03\] Data Access Manual HR-VPP products

\[AD04\]     HR-VPP for drought monitoring use case (upcoming)

\[AD05\]    HR-VPP for biomass monitoring use case (upcoming)

Even though the documents refer to HR-VPP they are relevant to MR-VPP since they follow similar methodology and utilize the same tools.

### 1.4.2 Reference documents

All referenced throughout this document are described in chapter 6. The related MR-VPP documents are noted as \[ADxx\] as shown in the table above.

## 1.5 Terminology

### 1.5.1 Terms

Phenology is generally defined rather loosely as "...the study of recurring plant and animal life cycle stages, especially their timing and relationships with weather and climate." (Schwartz 2013, c.f. Lieth 1974; Abbe 1905). In MR-VPP we have chosen to define phenology as the timing of development of photosynthetically active leaf foliage. Phenology in plants is driven by internal molecular processes leading to externally observable responses (Singh et al. 2017, Chmura et al. 2019). Some of these responses are difficult to observe (e.g., budset, or in-wintering), whereas the development of leaf area is visible both to human observers on the ground, and from satellite data. The development of leaf foliage can be described using leaf area index (LAI), which is a biophysical parameter defined as the one-sided leaf surface area over the corresponding ground area. Phenologicalparameters (phenometrics) describe specific stages on the seasonal growth curve (seasonal trajectory), e.g., the date of the start of the season, the length of the season, or the date of the end of the season.

### 1.5.2 Abbreviations and acronyms

|              |                                                                                     |
|--------------|-------------------------------------------------------------------------------------|
| **AD**       | Applicable Document                                                                 |
| **ATBD**     | Algorithm Theoretical Basis Document                                                |
| **COG**      | Cloud Optimised Geotiff                                                             |
| **DIAS**     | Data and Information Access Services                                                |
| **DOY**      | Day Of the Year                                                                     |
| **DVI**      | Difference Vegetation Index                                                         |
| **EOS**      | End of season                                                                       |
| **EVI**      | Enhanced Vegetation Index Gross Primary Productivity High Resolution                |
| **GPP**      |                                                                                     |
| **HR**       |                                                                                     |
| **HRVPP**    | High Resolution Vegetation Phenology and Productivity                               |
| **LAEA**     | Lambert Azimuthal Equal Area projection                                             |
| **LAI**      | Leaf Area Index                                                                     |
| **LINT**     | Large Integral                                                                      |
| **MDVI**     | Maximum difference vegetation index                                                 |
| **MR**       | Medium Resolution                                                                   |
| **MRVPP**    | Medium Resolution Vegetation Phenology and Productivity                             |
| **NBAR**     | nadir BRDF-Adjusted Reflectance                                                     |
| **NIR**      | Near Infra-Red                                                                      |
| **PPI**      | Plant Phenology Index                                                               |
| **QA**       | Quality Assessment                                                                  |
| **SINT**     | Small Integral                                                                      |
| **SOS**      | Start Of Season                                                                     |
| **VI**       | Vegetation Index                                                                    |
| **VPP**      | Vegetation Phenology and Productivity                                               |

# 2 Product description

## 2.1 Overview

The next paragraphs describe both collections:

* the 5-daily Plant Phenology Index (PPI)

* the yearly VPP metrics per season, up to two seasons:

  + Time for the start of the season

  + Time for the end of the season

  + Length of the season

  + Seasonal amplitude; difference between the maximum value and the base level

  + Rate of increase at the beginning of the season

  + Rate of decrease at the end of the season

  + Large seasonal integral

  + Small seasonal integral

  + Value for the start of the season

  + Value for the end of the season

  + Base level; given as the average of the left and right minimum values

  + Time for the mid of the season

  + Largest data value for the fitted function during the season

An example of a the VPP date layers for both seasons is in the Figure 3 shown for a cropland area in Poland close to the city Zambrów.

![Sample image of agriculture zone in Poland. Left is Google Earth RGB image, Middle from top to bottom: Start of Seasonl date, Maximum of Seasonl date, End ofSeasonl date; Right from top to bottom: Start of Season2 date, Maximum of Season2 date, End of Season2 date](clms_mrvpp_pum_d1.0-media/CLMS_MRVPP_PUM_D1.0-7.jpg){#fig-3  height=356px}

## 2.2 Plant Phenology Index (PPI)

The plant phenology index (PPI) is a physically-based vegetation index, developed from a simplified solution to the radiative transfer equation \[Jin et al, 2014\], PPI has a linear relationship with green leaf area index, strong correlation with gross primary productivity, and is shown capable of disentangling remotely sensed plant phenology from snow seasonality \[Jin et al., 2017, Jin et al., 2019\], PPI is reported to be superior to other indices for spring phenology retrieval over the northern latitudes \[Karkauskaite et al., 2016\] and for GPP estimation in African semi-arid ecosystems \[Abdi et al., 2019\]. Comparison of satellite-derived PPI to ground observations of plant phenology and gross primary productivity (GPP) shows strong similarity of temporal patterns over several Nordic boreal forest sites \[Jin et al., 2017\]. In the calibration of MR-VPP against GPP for 49 sites across Europe, PPI had a stronger relationship with GPP than the indices MDVI.

```{=latex}
\footnotesize
\renewcommand{\arraystretch}{2.0} % Increase vertical cell padding (default is 1.0)
%\rowcolors{2}{white}{gray!20} % Alternating rows: even rows gray, odd rows white
\setlength{\extrarowheight}{3pt} % Adds equal padding at the top and bottom
```

```{=html}
<table>
  <caption>Table 1: Product Specification PPI</caption>
  <thead style="background: pink;">
    <tr>
      <th>Specification</th>
      <th>Details</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="color: green;"><strong>Plant Phenology Index (500m)</strong></td>
      <td><strong>Acronym: VI-PPI</strong></td>
    </tr>
    <tr>
      <td>Temporal resolution (yyyy/mm)</td>
      <td>2000/5, per available MODIS tile</td>
    </tr>
    <tr>
      <td>Geometric resolution</td>
      <td></td>
    </tr>
    <tr>
      <td>Pixel resolution</td>
      <td>500m x 500m</td>
    </tr>
    <tr>
      <td>Coordinate Reference System</td>
      <td>Lambert Azimuth Equal Area (LAEA) grid</td>
    </tr>
    <tr>
      <td>Spatial Coverage</td>
      <td>EEA38 + UK</td>
    </tr>
    <tr>
      <td>Geometric accuracy (positioning accuracy)</td>
      <td>Less than 5%. According to NASA GSFC.</td>
    </tr>
    <tr>
      <td>Thematic accuracy</td>
      <td>Not applicable</td>
    </tr>
    <tr>
      <td>Data type</td>
      <td>16-bit signed raster</td>
    </tr>
    <tr>
      <td>Unit</td>
      <td>Dimensionless</td>
    </tr>
    <tr>
      <td>Raster coding (thematic pixel values)</td>
      <td>
        <ul>
          <li>0 to 3 (physical value)</li>
          <li>0 to 30000 (digital number)</li>
          <li>-1 (no value)</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>Scaling and offset</td>
      <td>0.0001 and 0.0</td>
    </tr>
    <tr>
      <td>Metadata</td>
      <td>XML metadata files according to INSPIRE metadata standards</td>
    </tr>
    <tr>
      <td>Delivery format</td>
      <td>
        Cloud Optimized GeoTIFF with the following options:
        <ul>
          <li>Lossless compression (deflate, zlevel = 4)</li>
          <li>Internal tiling (tiled = YES, blocksize = 256)</li>
          <li>Internal overviews (resolution levels [4,8,16] with "nearest" resampling method, gdal_tif_ovr_blocksize=256)</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>File naming convention</td>
      <td>
        <code>A&lt;YYYYMMDD&gt;DOY_&lt;TILE_ID&gt;_PPI_cog.tif</code>, with:
        <ul>
          <li><code>&lt;YYYYMMDD&gt;</code> gives the UTC date and time of the observation with the date (YYYY, MM, DD as year, month, day)</li>
          <li><code>&lt;TILEID&gt;</code> indicates the tile ID from the Sentinel-2 L1C product and defined as TXXXXX</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>File Size</td>
      <td>11.520 Mbytes per tile (2400 rows x 2400 columns)</td>
    </tr>
  </tbody>
</table>
```

```{=latex}
\normalsize
\renewcommand{\arraystretch}{1.5}
```

## 2.3 Vegetation Phenology and Productivity parameters (VPP)

Vegetation Phenological and Productivity parameters (VPP) will be extracted from the Plant Phenology Index (see above). Growing seasons can traverse years and hence the phenological parameters will be stored for up to two growing seasons per year.

```{=latex}
\footnotesize
\renewcommand{\arraystretch}{2.0} % Increase vertical cell padding (default is 1.0)
%\rowcolors{2}{white}{gray!20} % Alternating rows: even rows gray, odd rows white
\setlength{\extrarowheight}{3pt} % Adds equal padding at the top and bottom
```

```{=html}
<table>
  <caption>Table 2: Product Specification VPP</caption>
  <thead>
    <tr>
      <th>Attribute</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Vegetation Phenology and Productivity (10m)</td>
      <td>Acronym: VPP</td>
    </tr>
    <tr>
      <td>Temporal resolution (yyyy/mm)</td>
      <td>2000/01 – yearly</td>
    </tr>
    <tr>
      <td>Geometric resolution</td>
      <td>Pixel resolution 500m x 500m</td>
    </tr>
    <tr>
      <td>Coordinate Reference System</td>
      <td>Lambert Azimuth Equal Area (LAEA) grid</td>
    </tr>
    <tr>
      <td>Geometric accuracy (positioning accuracy)</td>
      <td>Less than 5%. According to NASA GSFC.</td>
    </tr>
    <tr>
      <td>Thematic accuracy</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <td>Data type</td>
      <td>16-bit signed raster</td>
    </tr>
    <tr>
      <td>Unit</td>
      <td>See table below</td>
    </tr>
    <tr>
      <td>Scaling and offset</td>
      <td>
        <ul>
          <li>1.0 and 0.0 for day units</li>
          <li>10000 and 0 for vegetation index values</li>
          <li>10 and 0 for productivity</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>Metadata</td>
      <td>XML metadata files according to INSPIRE metadata standards</td>
    </tr>
    <tr>
      <td>Delivery format</td>
      <td>
        Cloud Optimized GeoTIFF with the following options:
        <ul>
          <li>Lossless compression (deflate, zlevel = 4)</li>
          <li>Internal tiling (tiled = YES, blocksize = 256)</li>
          <li>Internal overviews (resolution levels [4,8,16] with "nearest" resampling method, gdal_tif_ovr_blocksize=256)</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>File naming convention</td>
      <td>
        <code>&lt;VPP&gt;_&lt;YYYY&gt;_&lt;SEASON&gt;_cog.tif</code>, with:
        <ul>
          <li><code>&lt;VPP&gt;</code>: Parameter name</li>
          <li><code>&lt;YYYY&gt;</code>: Year in ISO-8601 format</li>
          <li><code>&lt;SEASON&gt;</code>: Season 1 or Season 2</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>File Size</td>
      <td>~36 Mbytes per tile for 500m, season 1; ~8 Mbytes per tile for 500m, season 2</td>
    </tr>
  </tbody>
</table>
```
```{=latex}
\normalsize
\renewcommand{\arraystretch}{1.5}
```


```{=latex}
\footnotesize
\renewcommand{\arraystretch}{2.0} % Increase vertical cell padding (default is 1.0)
%\rowcolors{2}{white}{gray!20} % Alternating rows: even rows gray, odd rows white
\setlength{\extrarowheight}{3pt} % Adds equal padding at the top and bottom
```

```{=html}
<table>
         <caption>Raster coding (thematic pixel values per season)</caption>
         <thead>
          <tr>
            <th>File_ID</th>
            <th>File_ID Description</th>
            <th>Unit</th>
            <th>Digital Range</th>
            <th>No Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>SOS</td>
            <td>Day of start-of-season</td>
            <td rowspan="3">Day-of-Year</td>
            <td rowspan="3">
              <div>
              Format: YYDOY. E.g.,</br>
              18030: DOY 30 in year 2018</br>
              16001 - 65365
              </div>
            </td>
            <td rowspan="3">0</td>
          </tr>
          <tr>
            <td>EOS</td>
            <td>Day of end-of-season</td>
          </tr>
          <tr>
            <td>POS</td>
            <td>Day of maximum-of-season</td>
          </tr>
          <tr>
            <td>SOS value</td>
            <td>Vegetation index value at SOS</td>
            <td rowspan="5">PII</td>
            <td rowspan="5">
              <div>
              0 to 3 physical range</br>
              0 to 30000 digital range
              </div>
            </td>
            <td rowspan="5">-1</td>
          </tr>
          <tr>
            <td>EOS value</td>
            <td>Vegetation index value at EOS</td>
          </tr>
          <tr>
            <td>Base level</td>
            <td>Average vegetation index value of minima on left and right sides of each season</td>
          </tr>
          <tr>
            <td>Largest value</td>
            <td>Vegetation index value at POS</td>
          </tr>
          <tr>
            <td>Seasonal amplitude</td>
            <td>Difference between the maximum value and the base level</td>
          </tr>
          <tr>
            <td>LOS</td>
            <td>Length of Season (number of days between start and end)</td>
            <td>day</td>
            <td>1 to 1096</td>
            <td>0</td>
          </tr>
          <tr>
            <td>Increase rate</td>
            <td>Slope of the green-up period</td>
            <td rowspan="2">PPI × day</td>
            <td rowspan="2">
              0.01 to 0.5 physical range</br>
              100 to 5000 digital range
            </td>
            <td rowspan="2">-1</td>
          </tr>
          <tr>
            <td>Decrease rate</td>
            <td>Slope of the green-down period</td>
          </tr>
          <tr>
            <td>SINT</td>
            <td>Seasonal productivity. The growing season integral computed as the sum of all daily values between SOS and EOS</td>
            <td rowspan="2">PPI × day</td>
            <td rowspan="2">
              0 to +1095 physical range</br>
              0 to 10950 digital range
            </td>
            <td rowspan="2">-1</td>
          </tr>
          <tr>
            <td>LINT</td>
            <td>Total productivity. The growing season integral computed as sum of all daily values minus their base level value.</td>
          </tr>
        </tbody>
        </table>
```

```{=latex}
\normalsize
\renewcommand{\arraystretch}{1.5}
```
![Seasonal parameters (a) start of season (date, PPI value and slope), (b) end of season (date, PPI value and slope), (c) length of season, (d) minimum of season, (e) peak of the season (date and PPI value), (f) amplitude, (g) small integrated value, (g+h) large integrated value.](clms_mrvpp_pum_d1.0-media/CLMS_MRVPP_PUM_D1.0-11.jpg){#fig-4}

A maximum of two seasons will be detected per year and stored consecutively according to the date of the maximum value. In case of more seasons, the two largest seasons are selected.

The VPP parameters are assigned to the year of the date of the maximum value, being the first or second season.

# 3 Product methodology and workflow

## 3.1 Workflow Overview

The MR-VPP has been produced on the Copernicus Data and Access Information Service (DIAS) platform WEkEO. WEkEO is a federated cloud environment enabling a centralised and concurrent large-scale processing of extensive EO data volumes, ancillary and in-situ data. Storage resources and computing power were provided in the Elasticity by CloudFerro. The MR-VPP system, contains two major processing modules:

* Generation of the PPI and the derived VPP parameters (TIMESAT module).

* Post-processing to ease integration with other HR-layer products as Corine Land Cover and HRL layers (LAEA module).

This chapter provides a summarized description of all components of the TIM ESAT processing module. More details on the algorithm are provided in the Algorithm Theoretical Base Document (ATBD) \[AD01\],

## 3.2  Input Data

For the initial (2000-2021) processing:

* 500m Plant Phenology Index time-series from January 2000 to December 2021

* Quality Flag from the MCD43A2 product corresponding to the PPI time-series

&nbsp;

## 3.3  TIMESAT 4.1.2

This is a short summary of the principle of seasonality extraction and definition of growing seasons in TIMESAT 4 applied to MODIS data for the MR-VPP project. More information on the algorithm can be found in \[AD01\],

### 3.3.1  Gap filling

All tiles had missing data in year 2000 for Julian days 001, 006, Oil, 016, 021, 026, 031, 036, 041, 046 and 051. These days were gap filled using the mean value of the observations for the years 2001-2003 for each pixel originating from the same Julian day:

$$
PPI_{2000} = \frac{PPI_{2001} + PPI_{2002} + PPI_{2003}}{3}
$$

For other years, individual images that were missing have been filled with the data of the previous Julian day. However, only a handful images were missing.

Each tile covering the years 2000 to 2021 has 21 x 73 observations (where each tile has 2400 x 2400 x 2 bytes) and a total of "18 Gb input data for each tile.

### 3.3.2  Quality flags

Quality flags (QA flags) were derived from the MODIS MCD43A2 products and for pixels flagged[^1] as 'Best quality, full inversion', 'Good quality, full inversion', 'Magnitude inversion (numobs \>=7)' and 'Magnitude inversion (numobs \>=2&\<7)' PPI was calculated. All pixels flagged as 'Fill value' were excluded. Their combination through elementwise multiplication between bands was used to produce a quality image for each observation. All valid pixels were assigned a weight of 1, while all invalid pixels (Fill Value) got a weight of 0 assigned and were excluded from the analysis.

### 3.3.3 Time units

An interval of every fifth day is selected as units of time with the first day 1 January 2000 and the last day 31 December 2021, by including the first day of year (DOY) and the last DOY of each year but excluding day 366 of the leap years and considering year 2000 as the reference year.

### 3.3.4 Identification of seasons

In the constructed daily seasonal trajectory from the previous step, each potential season hasto be evaluated to determine if the magnitude is sufficiently large to consider it an independent season to extract, particularly for the potential seasons with small amplitude. For each potential season, TIMESAT determines if two close seasons should be merged.

### 3.3.5 Definition of start and end of growing seasons

The start and end of growing seasons are defined by searching the Plant Phenology Index for each defined season from the minimum value up to the peak level, setting the start of season to the time when the seasonal amplitude exceeds a user-defined value. The end of season is defined in a similar way. The threshold values are defined as 25 % of the seasonal amplitude for start of season and 15 % for the end of season. These values were derived in a thorough analysis based on PhenoCam images (32 sites), carbon flux measurements (49 sites), and manual phenology observations (PEP 725) over Europe (1321 sites) (Tian et al. 2021).

### 3.3.6 Extracting vegetation phonological parameters

Based on the defined growingOr i seasons, TIMESAT extracts 13 phonological parameters for each growing season, e.g., start of season, end of season, small integral etc. (Table 2 and Figure 4 Jonsson & Eklundh, 2004).

### 3.3.7 Assigning growing seasons to years

TIMESAT allows only storage of parameters for two growing seasons each calendar year. The seasons are assigned to year by the location of the season peaks. For example, with location of the season peak in 2019 the season will be assigned to 2019, however, the start of the season could occur in the previous year. If there are more than two growing seasons found in a year, TIMESAT will store the largest two seasons in the year, in chronological order.

## 3.4 LAEA

The post-processing module transforms the 500m UTM Seasonal Trajectories and VPP parameters into LAEA at the same 500m resolution.

## 3.5 Notes

Quality flags and TIMESAT weights

At the very beginning (prior to processing version 1), we only used pixels assigned "best quality" and "good quality" flags, however, this resulted in large gaps in the TIMESAT end products, therefore all pixels were used for processing 2000-2021. Since MODIS NBAR data is very smooth, unlike Sentinel-2 time-series, there is no need to use strict weight settings for MODIS NBAR. It is more important to not ignore too many data points.

Water mask

At the very beginning (prior to processing version 1), a water mask was applied to reduce the processing time in TIMESAT. TIMESAT only allows one land cover binary raster input for processing, which means the processing mask must be static. The water mask was derived from the MCD43A2 product which comes with a layer called "BRDF_Albedo_LandWaterType" with the classes:

0: Shallow ocean

1: Land (nothing else but land)

2: Ocean coastlines and lake shorelines

3: Shallow inland water

4: Ephemeral water

5: Deep inland water

6: Moderate or continental ocean

7: Deep ocean

Only the 'Deep Ocean' pixels were used to create the water masks. However, the layer turned out to contain "no data" values for cloudy pixels (Figure 5) which resulted in a flawed water mask and pixels over land were not processed. Therefore, the final processing was done without water mask within TIMESAT but applied as post-processing step on the TIMESAT results (cf. Section 5.1).

![Example of land water type layer and the impact of no data pixels due to clouds for two different dates.](clms_mrvpp_pum_d1.0-media/CLMS_MRVPP_PUM_D1.0-12.jpg){#fig-5}

Still, for future reprocessing it could be worth to apply a water mask to optimise processing time.

Mosaicking

It is important to create first the mosaics of the TIMESAT indices and only after reprojecting the mosaics to LAEA Europe, otherwise there will be gaps on the borders of tiles.

TIMESAT extraction

TIMESAT allows the extraction of in total 13 metrics (p. 26 of Eklundh & Jonsson, 2017 - and Figure 4 this report):

  1) time for the start of the season; time for which the left edge has increased to a user defined level (often a certain fraction of the seasonal amplitude) measured from the left minimum level.

  2) time for the end of the season; time for which the right edge has decreased to a user defined level measured from the right minimum level.

  3) length of the season; time from the start to the end of the season.

  4) base level; given as the average of the left and right minimum values.

  5) time for the mid of the season; computed as the mean value of the times for which, respectively, the left edge has increased to the 80 % level and the right edge has decreased to the 80 % level.

  6) largest data value for the fitted function during the season; may occur at a different time compared with 5.

  7) seasonal amplitude; difference between the maximum value and the base level.

  8) rate of increase at the beginning of the season; calculated as the ratio of the difference between the left 20 % and 80 % levels and the corresponding time difference.

  9) rate of decrease at the end of the season; calculated as the absolute value of the ratio of the difference between the right 20 % and 80 % levels and the corresponding time difference. The rate of decrease is thus given as a positive quantity.

  10) large seasonal integral; integral of the function describing the season from the season start to the season end. Note that the large integral has no meaning when part of the fitted function is negative.

  11) small seasonal integral; integral of the difference between the function describing the season and the base level from season start to season end.

  12) value for the start of the season; value of the function at the time of the start of the season.

  13) value for the end of the season; value of the function at the time of the end of the season.

In this project we derived all the 13 indices, with phenology being the numbers 1, 2, 3, 8, 9 and productivity being the numbers 7, 10, 11. For the next MR VPP update all indices should be extracted to have all at hand and full flexibility for further processing.

MODIS Reprocessing

The MR VPP processing was done with MODIS MCD43 collection 6 data. Currently the collection 6 MCD43 data is reprocessed to collection 6.1. and will soon replace the collection 6 data [^2]. As soon as the collection 6.1 will be available, it is strongly advised to switch to the reprocessed data. This may also entail a reprocessing of the time series with TIMESAT. The reason behind the announcement is the incorrect representation of the aerosol quantities in the C6 MYD09 and MOD09 surface reflectance products that may have impacted downstream products particularly over arid bright surfaces[^3]. At time of production (June 2022) the collection 6.1 was still incomplete. Therefore, we had to fall back to collection 6.

For MR VPP updates with MODIS collection 6.0

As for MDVI (and DVI_(SO)ii), Lars Eklund (email correspondence 6 April 2022) would suggest applying the same MDVI to future calculations a few more years. Then it may be reasonable to update it. In that way there will some different generations of PPI. This is the way chosen in the HR-VPP project. The update interval is not easy to define but perhaps every 5-10 years. When updating with new years in TIMESAT it is important to keep an overlap period to avoid gaps between the periods.

In this project, the seasonal methods used (1 % season start method) is based on the thresholds (25% for SOS, and 15% for EOS) of individual years. So, the phenology retrieval can by just extended by additional years without considering the amplitude of preceding years.

For MR VPP updates with MODIS collection 6.1

With MODIS MCD43 NBAR currently being reprocessed to collection 6.1, the updating of MR VPP would require a complete reprocessing of the entire time series. The calculation of PPI is the most computational step in the processing workflow. Since the workflow has been implemented and tested on Cloudferro, the update can be conducted relatively fast once the MODIS data is ready.

Connection of MR-VPP and HR-VPP naming convention

| **MRVPP Field**       | **HRVPP Field**  | **Description**                                                                                                  |
|-----------------------|------------------|------------------------------------------------------------------------------------------------------------------|
| SOS                   | SOSD             | Day of start-of-season                                                                                          |
| EOS                   | EOSD             | Day of end-of-season                                                                                            |
| POS                   | MAXD             | Day of maximum-of-season                                                                                        |
| SOS value             | SOSV             | Vegetation index value at SOSD                                                                                  |
| EOS value             | EOSV             | Vegetation index value at EOSD                                                                                  |
| LOS                   | LENGTH           | Length of season                                                                                                |
| Largest value         | MAXV             | Vegetation index value at POS                                                                                   |
| Base level            | MINV             | Average vegetation index value of minima on left and right sides of each season                                 |
| Seasonal amplitude    | AMPL             | Difference between the maximum value and the base level                                                         |
| Increase rate         | LSLOPE           | Slope of the green-up period                                                                                    |
| Decrease rate         | RSLOPE           | Slope of the green-down period                                                                                  |
| SINT                  | SPROD            | Seasonal productivity. The growing season integral computed as the sum of all daily values between SOS and EOS   |
| LINT                  | TPROD            | Total productivity. The growing season integral computed as the sum of all daily values minus their base level value. |

: Table 3: MR-VVP & HR-VPP naming

# 4 Quality assessment

No quality assessment was applied.

# 5 Terms of use and product technical support

&nbsp;

* Terms of use

The product(s) described in this document is/are created in the frame of the Copernicus programme of the European Union by the European Environment Agency (product custodian) and is/are owned by the European Union. The product(s) can be used following Copernicus full free and open data policy, which allows the use of the product(s) also for any commercial purpose. Derived products created by end users from the product(s) described in this document are owned by the end users, who have all intellectual rights to the derived products.

*   Citation

In cases of re-dissemination of the product(s) described in this document or when the product(s) is/are used to create a derived product it is required to provide a reference to the source. A template is provided below:

"© European Union, Copernicus Land Monitoring Service \<year\>, European Environment Agency (EEA)"

*   Product technical support

Product technical support is provided by the product custodian through Copernicus Land Monitoring Service helpdesk at copernicusffieea.europa.eu. Product technical support doesn't include software specific user support or general GIS or remote sensing support.

*   Product access

More information on the products can be found at the Copernicus Land Monitoring Service website ( [https://land.copernicus.eu/](https://land.copernicus.eu/) )

The data access interface on WEkEO cloud allows users to search, browse and downloading the product catalogue. Users must register before downloading the products. It also offers free browsing of the HR-VPP products through a Web Mapping Tile Service (WMTS).

Direct access to the products is provided through an HTTP API allowing REST queries and a direct Amazon File system interface on the WEkEO cloud.

More details on product access can be found in \[AD9\],

# 6 References

Abbe, C. (1905). A first report on the relations between climates and crops. Washington: Government Printing Office.

Chmura, H. E., Kharouba, H. M., Ashander, J., Ehlman, S. M., Rivest, E. B., & Yang, L. H. (2019). The mechanisms of phenology: the patterns and processes of phonological shifts. Ecological Monographs, 89, e01337.

Jonsson, P., Cai, Z., Melaas, E., Friedl, M., & Eklundh, L. (2018). A Method for Robust Estimation of Vegetation Seasonality from Landsat and Sentinel-2 Time Series Data. Remote Sensing, 10, 635.

Jonsson, P., & Eklundh, L. (2004). TIM ESAT - a program for analyzing time-series of satellite sensor data. Computers & Geosciences, 30, 833-845.

Lieth H. (1974). Phenology and Seasonality Modeling, Ecological Studies-Analysis and Synthesis Series, Vol 8, Springer-Verlag.

Schwartz, M.D. (2013). Phenology: An Integrative Environmental Science. Dordrecht: Springer.

Singh, R. K., T. Svystun, B. AIDahmash, A. M. Jonsson & R. P. Bhalerao (2017) Photoperiod- and temperature-mediated control of phenology in trees - a molecular perspective. New Phytologist, 213, 511-524.

Tian, F., Cai, Z., Jin, H., Hufkens, K., Scheifinger, H., Tagesson, T., Smets, B., Van Hoolst, R., Bonte, K., Ivits, E., Tong, X., Ardó, J., & Eklundh, L. (2021). Calibrating vegetation phenology from Sentinel-2 using eddy covariance, PhenoCam, and PEP725 networks across Europe. Remote Sensing of Environment, 260, 112456.

MR-VPP Product User Manual Plant Phenology Index and VPP parameters, issue 1.0

[^1]:
[https://ladsweb.modaDs.eosdis.nasa.gov/filesDec/MODIS/6/MCD43A2](https://ladsweb.modaDs.eosdis.nasa.gov/filesDec/MODIS/6/MCD43A2) (accessed January 2021)

[^2]:
[https://lpdaac.usgs.gov/news/lp-daac-releases-modis-version-61-brdfalbedo-data-products/](https://lpdaac.usgs.gov/news/lp-daac-releases-modis-version-61-brdfalbedo-data-products/) (accessed March 2021)

[^3]:
[https://landweb.modaps.eosdis.nasa.gov/QA WWW/forPage/LSRHighAerosolFlagFinal.pdf](https://landweb.modaps.eosdis.nasa.gov/QA_WWW/forPage/LSRHighAerosolFlagFinal.pdf) (accessed March 2021)
